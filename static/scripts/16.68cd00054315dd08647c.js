(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{0:function(t,e){},1:function(t,e){},Al62:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return r}));var n=function(t,e){if(void 0===e&&(e={}),!t)return null;function i(t){}t.addEventListener("webglcontextcreationerror",i,!1);var n=t.getContext("webgl2",e);return(n=n||t.getContext("experimental-webgl2",e))||(n=(n=t.getContext("webgl",e))||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),n},a=window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI;function r(){return Math.ceil(a)||1}},"R1+Y":function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var n=i("1OyB"),a=i("vuIU"),r=i("md7G"),o=i("foSv"),s=i("Ji7U"),l=i("2tSu"),c=i("rpwb"),h=i("5lV4"),u=i("KHNG"),d=i("ctuC"),p=i("3DrS"),g=i("Im0j"),f=new l.a,v={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},material:f},m=function(t){function e(){return Object(n.a)(this,e),Object(r.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(a.a)(e,[{key:"initializeState",value:function(){this.state={paths:[]}}},{key:"updateState",value:function(t){var e=this,i=(t.oldProps,t.props,t.changeFlags),n=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon);if(n&&Array.isArray(i.dataChanged)){var a=this.state.paths.slice(),r=i.dataChanged.map((function(t){return Object(g.a)({data:a,getIndex:function(t){return t.__source.index},dataRange:t,replace:e._getPaths(t)})}));this.setState({paths:a,pathsDiff:r})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.props,i=e.data,n=e.getPolygon,a=[],r="XY"===e.positionFormat?2:3,o=t.startRow,s=t.endRow,l=Object(c.a)(i,o,s),h=l.iterable,u=l.objectInfo,d=!0,g=!1,f=void 0;try{for(var v,m=h[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var y=v.value;u.index++;var w=p.c(n(y,u),r),b=w.positions,C=w.holeIndices;if(C)for(var L=0;L<=C.length;L++){var P=b.subarray(C[L-1]||0,C[L]||b.length);a.push(this.getSubLayerRow({path:P},y,u.index))}else a.push(this.getSubLayerRow({path:b},y,u.index))}}catch(t){g=!0,f=t}finally{try{d||null==m.return||m.return()}finally{if(g)throw f}}return a}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,i=t._dataDiff,n=t.stroked,a=t.filled,r=t.extruded,o=t.wireframe,s=t.elevationScale,l=t.transitions,c=t.positionFormat,h=this.props,p=h.lineWidthUnits,g=h.lineWidthScale,f=h.lineWidthMinPixels,v=h.lineWidthMaxPixels,m=h.lineJointRounded,y=h.lineMiterLimit,w=h.lineDashJustified,b=this.props,C=b.getFillColor,L=b.getLineColor,P=b.getLineWidth,x=b.getLineDashArray,k=b.getElevation,R=b.getPolygon,_=b.updateTriggers,M=b.material,S=this.state,O=S.paths,T=S.pathsDiff,j=this.getSubLayerClass("fill",u.a),E=this.getSubLayerClass("stroke",d.a),D=this.shouldRenderSubLayer("fill",O)&&new j({_dataDiff:i,extruded:r,elevationScale:s,filled:a,wireframe:o,getElevation:k,getFillColor:C,getLineColor:L,material:M,transitions:l},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:_.getPolygon,getElevation:_.getElevation,getFillColor:_.getFillColor,getLineColor:_.getLineColor}}),{data:e,positionFormat:c,getPolygon:R});return[!r&&D,!r&&n&&this.shouldRenderSubLayer("stroke",O)&&new E({_dataDiff:T&&function(){return T},widthUnits:p,widthScale:g,widthMinPixels:f,widthMaxPixels:v,rounded:m,miterLimit:y,dashJustified:w,transitions:l&&{getWidth:l.getLineWidth,getColor:l.getLineColor,getPath:l.getPolygon},getColor:this.getSubLayerAccessor(L),getWidth:this.getSubLayerAccessor(P),getDashArray:this.getSubLayerAccessor(x)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:_.getLineWidth,getColor:_.getLineColor,getDashArray:_.getLineDashArray}}),{data:O,positionFormat:c,getPath:function(t){return t.path}}),r&&D]}}]),e}(h.a);m.layerName="PolygonLayer",m.defaultProps=v},tjUo:function(t,e,i){"use strict";var n=i("zGfa"),a=i("mybv"),r=i("7GCR"),o=i("Al62");function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var l={registerEvents:!0,renderer:"webgl",doubleBuffer:!0,glOptions:{alpha:!0,depth:!0,antialias:!0,stencil:!0},forceRenderOnMoving:!0,forceRenderOnZooming:!0},c={useDevicePixels:!0,autoResizeDrawingBuffer:!1},h=12756274*Math.PI/(256*Math.pow(2,20));function u(t){var e=t.getResolution(),i=t.getMaxNativeZoom(),n=t.getCenter(),a=t.getPitch(),r=t.getBearing();return{latitude:n.y,longitude:n.x,zoom:function(t){return 19-Math.log(t/h)/Math.LN2}(e),bearing:r,pitch:a,maxZoom:i}}var d=function(t){function e(e,i,n){var a;return void 0===n&&(n={}),(a=t.call(this,e,Object.assign(l,n))||this).props=Object.assign({},c,i),a._isLoad=!1,a}s(e,t);var i=e.prototype;return i.setProps=function(t){return Object.assign(this.props,t,{id:this.id}),this},i.getProps=function(){return this.props},i.prepareToDraw=function(){},i.draw=function(){this.renderLayer()},i.drawOnInteracting=function(){this.renderLayer()},i.onAdd=function(){},i.onMouseClick=function(t){var e={};t.offsetCenter||(e={type:"click",offsetCenter:t.containerPoint,srcEvent:t.domEvent}),this.deck._onEvent(e)},i.onMouseMove=function(t){var e={};t.offsetCenter||(e={offsetCenter:t.containerPoint,srcEvent:t.domEvent}),this.deck._onPointerMove(e)},i.onMouseDown=function(t){var e={};t.offsetCenter||(e={offsetCenter:t.containerPoint,srcEvent:t.domEvent}),this.deck._onPointerDown(e)},i.onRemove=function(){},i.renderLayer=function(){var t=this,e=this.getMap(),i=this._getRenderer();if(i&&e){var n=this.props._customRender,r=i.gl,o=Object.assign(this.props,{gl:r,width:!1,height:!1,viewState:u(e),_customRender:function(){n&&n()},parameters:{depthMask:!0,depthTest:!0,blendFunc:[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],blendEquation:r.FUNC_ADD},userData:{isExternal:!1,layers:new Set},onLoad:function(){t._isLoad=!0,t._drawLayer(e)}});this.deck||this._isLoad||(this.deck=new a.a(o),this.options.registerEvents&&(e.on("mousemove",this.onMouseMove,this),e.on("mousedown",this.onMouseDown,this),e.on("click",this.onMouseClick,this))),this._isLoad&&(this.deck.setProps(o),this.deck.props.userData.isExternal=!0,this._drawLayer(e)),i.completeRender()}},i._drawLayer=function(t){var e=this.deck.props.userData.currentViewport;e||(e=function(t,e,i){return void 0===i&&(i=!0),new n.a(Object.assign({x:0,y:0,width:t.width,height:t.height},u(e),i?{nearZMultiplier:t.height?1/t.height:1,farZMultiplier:1.01}:{nearZMultiplier:.1,farZMultiplier:10}))}(this.deck,t,!0),this.deck.props.userData.currentViewport=e),this.deck.layerManager&&this.deck._drawLayers("maptalks-deck-repaint",{viewports:[e],clearCanvas:!1})},i.remove=function(){var e=this.getMap();this.deck&&e&&(this.options.registerEvents&&(e.off("mousemove",this.onMouseMove,this),e.off("mousedown",this.onMouseDown,this),e.off("click",this.onMouseClick,this)),this.deck.finalize(),delete this.deck),t.prototype.remove.call(this)},e}(r.CanvasLayer),p=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var i=e.prototype;return i.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer()},i.needToRedraw=function(){var e=this.getMap();return!(e.isZooming()&&!e.getPitch())&&t.prototype.needToRedraw.call(this)},i.createCanvas=function(){if(!this.canvas&&!this.gl){var t=this.getMap(),e=t.getSize(),i=(t.getDevicePixelRatio?t.getDevicePixelRatio():Object(o.b)())||1,n=[i*e.width,i*e.height],a=n[0],s=n[1];this.canvas=r.Canvas.createCanvas(a,s,t.CanvasClass),this.canvas.style&&(this.canvas.style.width=e+"px",this.canvas.style.height=e+"px"),this.gl=Object(o.a)(this.canvas,this.layer.options.glOptions),this.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}},i.resizeCanvas=function(t){if(this.canvas){var e=this.getMap(),i=(e.getDevicePixelRatio?e.getDevicePixelRatio():Object(o.b)())||1,n=t||e.getSize();this.canvas.width===n.width*i&&this.canvas.height===n.height*i||(this.canvas.height=i*n.height,this.canvas.width=i*n.width,this.gl.viewport(0,0,this.canvas.width,this.canvas.height))}},i.clearCanvas=function(){this.canvas&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height))},i.requestMapToRender=function(){this.setToRedraw()},i.prepareCanvas=function(){this.canvas?this.clearCanvas():this.createCanvas();var e=t.prototype.prepareCanvas.call(this);return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),e},i.onZoomStart=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t.prototype.onZoomStart.call(this,i)},i.onZoomEnd=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t.prototype.onZoomEnd.call(this,i)},i.remove=function(){t.prototype.remove.call(this)},e}(r.renderer.CanvasLayerRenderer);d.registerRenderer("webgl",p),e.a=d},zbPL:function(t,e,i){"use strict";i.r(e);var n=i("q1tI"),a=i.n(n),r=i("tjUo"),o=i("R1+Y"),s=i("1OyB"),l=i("vuIU"),c=i("md7G"),h=i("foSv"),u=i("ReuC"),d=i("Ji7U"),p=i("ctuC"),g=i("rpwb"),f=function(t){function e(){return Object(s.a)(this,e),Object(c.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(l.a)(e,[{key:"getShaders",value:function(){var t=Object(u.a)(Object(h.a)(e.prototype),"getShaders",this).call(this);return t.inject={"vs:#decl":"uniform float trailLength;\nuniform bool isPath3D;\nattribute vec2 instanceTimestamps;\nvarying float vTime;\n","vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);":"vec2 timestamps = instanceTimestamps;\nif (!isPath3D) {\n  prevPosition.z = 0.0;\n  currPosition.z = 0.0;\n  nextPosition.z = 0.0;\n  timestamps.x = instanceStartPositions.z;\n  timestamps.y = instanceEndPositions.z;\n}\n","vs:#main-end":"float shiftZ = sin(timestamps.x) * 1e-4;\ngl_Position.z += shiftZ;\nvTime = timestamps.x + (timestamps.y - timestamps.x) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || vTime < currentTime - trailLength) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"color.a *= 1.0 - (currentTime - vTime) / trailLength;"},t}},{key:"initializeState",value:function(t){Object(u.a)(Object(h.a)(e.prototype),"initializeState",this).call(this,t),this.getAttributeManager().addInstanced({instanceTimestamps:{size:2,update:this.calculateInstanceTimestamps}})}},{key:"draw",value:function(t){var i=this.props,n=i.trailLength,a=i.currentTime,r=i.getTimestamps;t.uniforms=Object.assign({},t.uniforms,{trailLength:n,currentTime:a,isPath3D:Boolean(r)}),Object(u.a)(Object(h.a)(e.prototype),"draw",this).call(this,t)}},{key:"calculateInstanceTimestamps",value:function(t,e){var i=e.startRow,n=e.endRow,a=this.props,r=a.data,o=a.getTimestamps;if(!o)return t.constant=!0,void(t.value=new Float32Array(2));for(var s=this.state.pathTesselator,l=s.bufferLayout,c=s.instanceCount,h=new Float32Array(2*c),u=Object(g.a)(r,i,n),d=u.iterable,p=u.objectInfo,f=0,v=0;v<i;v++)f+=2*l[v];var m=!0,y=!1,w=void 0;try{for(var b,C=d[Symbol.iterator]();!(m=(b=C.next()).done);m=!0){var L=b.value;p.index++;for(var P=l[p.index],x=o(L,p),k=0;k<P;k++)h[f++]=x[k],h[f++]=x[k+1]}}catch(t){y=!0,w=t}finally{try{m||null==C.return||C.return()}finally{if(y)throw w}}t.constant=!1,t.value=h}}]),e}(p.a);f.layerName="TripsLayer",f.defaultProps={trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var v=i("7GCR"),m=i("2tSu"),y=i("Tl6c"),w=i("KhhE"),b=i("8rZH"),C=i("Al62");function L(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var x=new y.a({color:[255,255,255],intensity:1}),k=new w.a({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),R=new b.a({ambientLight:x,pointLight:k}),_={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:new m.a({ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]}),effects:[R]},M=[[[-74,40.7],[-74.02,40.7],[-74.02,40.72],[-74,40.72]]],S=function(t){function e(e,i){var n;return P(L(n=t.call(this,e,i)||this),"_animate",(function(){var t=Date.now()/1e3%60/60*1800,e={layers:[new o.a({id:"ground",data:M,getPolygon:function(t){return t},stroked:!1,getFillColor:[0,0,0,0]}),new f({id:"trips",data:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/trips/trips-v7.json",currentTime:t,getPath:function(t){return t.path},getTimestamps:function(t){return t.timestamps},getColor:function(t){return 0===t.vendor?_.trailColor0:_.trailColor1},opacity:.3,widthMinPixels:2,rounded:!0,trailLength:180,shadowEnabled:!1}),new o.a({id:"buildings",data:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/trips/buildings.json",extruded:!0,wireframe:!1,opacity:.5,getPolygon:function(t){return t.polygon},getElevation:function(t){return t.height},getFillColor:_.buildingColor,material:_.material})]};n.inited?n.deckLayer&&n.deckLayer.setProps(e):(n.inited=!0,n.deckLayer=new r.a("deck",e,{animation:!0,renderer:"webgl"}),n.map.addLayer(n.deckLayer)),window.requestAnimationFrame(n._animate)})),P(L(n),"setRef",(function(t){void 0===t&&(t=null),n.container=t})),n.state={zoom:14,fov:0,pitch:0,bearing:0},n.container=null,n.map=null,n.inited=!1,n.deckLayer=null,n}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var i=e.prototype;return i.componentDidMount=function(){this.map=new v.Map(this.container,{center:[-74,40.72],zoom:13,pitch:40.5,bearing:0,centerCross:!0,baseLayer:new v.TileLayer("tile",{urlTemplate:"https://api.mapbox.com/styles/v1/mapbox/dark-v10/tiles/{z}/{x}/{y}"+(Object(C.b)()>1.5?"@2x":"")+"?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejh2N21nMzAxMmQzMnA5emRyN2lucW0ifQ.jSE-g2vsn48Ry928pqylcg"})}),this._animate()},i.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},i.render=function(){return a.a.createElement("div",{ref:this.setRef,className:"map-content"})},e}(a.a.Component);e.default=S}}]);