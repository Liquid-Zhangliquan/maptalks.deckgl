(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{0:function(e,t){},1:function(e,t){},Al62:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));var n=function(e,t){if(void 0===t&&(t={}),!e)return null;function i(e){}e.addEventListener("webglcontextcreationerror",i,!1);var n=e.getContext("webgl2",t);return(n=n||e.getContext("experimental-webgl2",t))||(n=(n=e.getContext("webgl",t))||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",i,!1),n},a=window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI;function r(){return Math.ceil(a)||1}},oRDS:function(e,t,i){"use strict";i.r(t);var n=i("q1tI"),a=i("7GCR"),r=i("2tSu"),o=i("Tl6c"),s=i("KhhE"),c=i("8rZH"),h=i("TOFf"),l=i("tjUo"),u=i("Al62");function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var d=new o.a({color:[255,255,255],intensity:1}),v=new s.a({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),f=new s.a({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),g=(new c.a({ambientLight:d,pointLight1:v,pointLight2:f}),new r.a({ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]})),m={lightsPosition:[-.144528,49.739968,8e3,-3.807751,54.104682,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},w=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],y={min:1,max:50},b=function(e){function t(t,i){var n;return function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(p(n=e.call(this,t,i)||this),"setRef",(function(e){void 0===e&&(e=null),n.container=e})),n.state={zoom:14,fov:0,pitch:0,bearing:0},n.container=null,n.map=null,n.deckLayer=null,n.state={elevationScale:y.min},n.startAnimationTimer=null,n.intervalTimer=null,n._startAnimate=n._startAnimate.bind(p(n)),n._animateHeight=n._animateHeight.bind(p(n)),n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this;this.map=new a.Map(this.container,{center:[-1.4157267858730052,52.232395363869415],zoom:7,pitch:40.5,bearing:-27.396674584323023,centerCross:!0,baseLayer:new a.TileLayer("tile",{urlTemplate:"https://api.mapbox.com/styles/v1/mapbox/dark-v10/tiles/{z}/{x}/{y}"+(Object(u.b)()>1.5?"@2x":"")+"?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejh2N21nMzAxMmQzMnA5emRyN2lucW0ifQ.jSE-g2vsn48Ry928pqylcg"})}),i("DRYM").csv("https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv",(function(t,i){if(!t){var n=i.map((function(e){return[Number(e.lng),Number(e.lat)]}));e._animate(n)}}))},r._animate=function(e){this.setState({data:e}),this._stopAnimate(),this.startAnimationTimer=window.setTimeout(this._startAnimate,1500)},r._startAnimate=function(){this.intervalTimer=window.setInterval(this._animateHeight,20)},r._stopAnimate=function(){window.clearTimeout(this.startAnimationTimer),window.clearTimeout(this.intervalTimer)},r._animateHeight=function(){this.state.elevationScale===y.max?this._stopAnimate():this.setState({elevationScale:this.state.elevationScale+1})},r._renderLayers=function(){var e=this.state,t=e.data,i=e.radius,n=void 0===i?1e3:i,a=e.upperPercentile,r=void 0===a?100:a,o=e.coverage,s=void 0===o?1:o;if(t){var c={layers:[new h.a({id:"heatmap",colorRange:w,coverage:s,data:t,elevationRange:[0,3e3],elevationScale:this.state.elevationScale,extruded:!0,getPosition:function(e){return e},lightSettings:m,onHover:this.props.onHover,opacity:1,pickable:Boolean(this.props.onHover),radius:n,upperPercentile:r,material:g,transitions:{elevationScale:3e3}})]};this.inited?this.deckLayer&&this.deckLayer.setProps(c):(this.inited=!0,this.deckLayer=new l.a("deck",c,{animation:!0,renderer:"webgl"}),this.map.addLayer(this.deckLayer))}},r.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},r.render=function(){return this._renderLayers(),n.createElement("div",{ref:this.setRef,className:"map-content"})},t}(n.Component);t.default=b},tjUo:function(e,t,i){"use strict";var n=i("zGfa"),a=i("mybv"),r=i("7GCR"),o=i("Al62");function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var c={registerEvents:!0,renderer:"webgl",doubleBuffer:!0,glOptions:{alpha:!0,depth:!0,antialias:!0,stencil:!0},forceRenderOnMoving:!0,forceRenderOnZooming:!0},h={useDevicePixels:!0,autoResizeDrawingBuffer:!1},l=12756274*Math.PI/(256*Math.pow(2,20));function u(e){var t=e.getResolution(),i=e.getMaxNativeZoom(),n=e.getCenter(),a=e.getPitch(),r=e.getBearing();return{latitude:n.y,longitude:n.x,zoom:function(e){return 19-Math.log(e/l)/Math.LN2}(t),bearing:r,pitch:a,maxZoom:i}}var p=function(e){function t(t,i,n){var a;return void 0===n&&(n={}),(a=e.call(this,t,Object.assign(c,n))||this).props=Object.assign({},h,i),a._isLoad=!1,a}s(t,e);var i=t.prototype;return i.setProps=function(e){return Object.assign(this.props,e,{id:this.id}),this},i.getProps=function(){return this.props},i.prepareToDraw=function(){},i.draw=function(){this.renderLayer()},i.drawOnInteracting=function(){this.renderLayer()},i.onAdd=function(){},i.onMouseClick=function(e){var t={};e.offsetCenter||(t={type:"click",offsetCenter:e.containerPoint,srcEvent:e.domEvent}),this.deck._onEvent(t)},i.onMouseMove=function(e){var t={};e.offsetCenter||(t={offsetCenter:e.containerPoint,srcEvent:e.domEvent}),this.deck._onPointerMove(t)},i.onMouseDown=function(e){var t={};e.offsetCenter||(t={offsetCenter:e.containerPoint,srcEvent:e.domEvent}),this.deck._onPointerDown(t)},i.onRemove=function(){},i.renderLayer=function(){var e=this,t=this.getMap(),i=this._getRenderer();if(i&&t){var n=this.props._customRender,r=i.gl,o=Object.assign(this.props,{gl:r,width:!1,height:!1,viewState:u(t),_customRender:function(){n&&n()},parameters:{depthMask:!0,depthTest:!0,blendFunc:[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],blendEquation:r.FUNC_ADD},userData:{isExternal:!1,layers:new Set},onLoad:function(){e._isLoad=!0,e._drawLayer(t)}});this.deck||this._isLoad||(this.deck=new a.a(o),this.options.registerEvents&&(t.on("mousemove",this.onMouseMove,this),t.on("mousedown",this.onMouseDown,this),t.on("click",this.onMouseClick,this))),this._isLoad&&(this.deck.setProps(o),this.deck.props.userData.isExternal=!0,this._drawLayer(t)),i.completeRender()}},i._drawLayer=function(e){var t=this.deck.props.userData.currentViewport;t||(t=function(e,t,i){return void 0===i&&(i=!0),new n.a(Object.assign({x:0,y:0,width:e.width,height:e.height},u(t),i?{nearZMultiplier:e.height?1/e.height:1,farZMultiplier:1.01}:{nearZMultiplier:.1,farZMultiplier:10}))}(this.deck,e,!0),this.deck.props.userData.currentViewport=t),this.deck.layerManager&&this.deck._drawLayers("maptalks-deck-repaint",{viewports:[t],clearCanvas:!1})},i.remove=function(){var t=this.getMap();this.deck&&t&&(this.options.registerEvents&&(t.off("mousemove",this.onMouseMove,this),t.off("mousedown",this.onMouseDown,this),t.off("click",this.onMouseClick,this)),this.deck.finalize(),delete this.deck),e.prototype.remove.call(this)},t}(r.CanvasLayer),d=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var i=t.prototype;return i.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer()},i.needToRedraw=function(){var t=this.getMap();return!(t.isZooming()&&!t.getPitch())&&e.prototype.needToRedraw.call(this)},i.createCanvas=function(){if(!this.canvas&&!this.gl){var e=this.getMap(),t=e.getSize(),i=(e.getDevicePixelRatio?e.getDevicePixelRatio():Object(o.b)())||1,n=[i*t.width,i*t.height],a=n[0],s=n[1];this.canvas=r.Canvas.createCanvas(a,s,e.CanvasClass),this.canvas.style&&(this.canvas.style.width=t+"px",this.canvas.style.height=t+"px"),this.gl=Object(o.a)(this.canvas,this.layer.options.glOptions),this.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}},i.resizeCanvas=function(e){if(this.canvas){var t=this.getMap(),i=(t.getDevicePixelRatio?t.getDevicePixelRatio():Object(o.b)())||1,n=e||t.getSize();this.canvas.width===n.width*i&&this.canvas.height===n.height*i||(this.canvas.height=i*n.height,this.canvas.width=i*n.width,this.gl.viewport(0,0,this.canvas.width,this.canvas.height))}},i.clearCanvas=function(){this.canvas&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height))},i.requestMapToRender=function(){this.setToRedraw()},i.prepareCanvas=function(){this.canvas?this.clearCanvas():this.createCanvas();var t=e.prototype.prepareCanvas.call(this);return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),t},i.onZoomStart=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.prototype.onZoomStart.call(this,i)},i.onZoomEnd=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.prototype.onZoomEnd.call(this,i)},i.remove=function(){e.prototype.remove.call(this)},t}(r.renderer.CanvasLayerRenderer);p.registerRenderer("webgl",d),t.a=p}}]);